{
    "collab_server" : "",
    "contents" : "---\ntitle: \"RLisbonaMSDS6306Unit9_5FinancialDataAnalysis\"\nauthor: \"Randy Lisbona\"\ndate: \"July 17, 2016\"\noutput: html_document\nkeep_md: true\n---\n\n```{r setup, include=FALSE}\nknitr::opts_chunk$set(echo = TRUE)\nlibrary(\"zoo\")\nlibrary(\"ggplot2\")\nlibrary(\"tseries\")\nlibrary(\"knitr\")\n\nCurrentwd <- getwd()\nsetwd(Currentwd)\ngetwd()\n\n#########################################################################\n## volatilityget function\n#########################################################################\n\n\nVolhistorical <- function(d,logreturns){\n  var=0\n  lam=0\n  varlist<-c()\n  for (r in logreturns){\n    lam = lam*(1-1/d) +1\n    var = (1-1/lam) * var + (1/lam)*r^2\n    varlist <- c(varlist,var)\n  }\n  sqrt(varlist)}\n#########################################################################\n# function to download the historical data and do some basic calculations\n#########################################################################\nAnalyzeStock <- function(ticker){\n  DailyClosingPrice <- get.hist.quote(ticker,quote=\"Close\",quiet=TRUE)  \n  \n  begindt <- start(DailyClosingPrice)\n  enddt <- end(DailyClosingPrice)\n  \n  obs=length(DailyClosingPrice)\n  \n  logreturns <- log(lag(DailyClosingPrice))-log(DailyClosingPrice)\n  # 252 trading days per year\n  vol <- round(sd(logreturns) * sqrt(252)*100,2)\n  plottitle <- paste(\"Historical Closing price for (\",ticker,\") for period \",begindt, \" to \", enddt,\"\\n\",\n                     \" Obs= \",obs,\"  \",\"Historical Volatility = \",vol,sep=\"\")\n  \n  list(Ticker = ticker,\n       Data=DailyClosingPrice,\n       Obs=obs,\n       LogReturns=logreturns,\n       BeginDate=begindt,\n       EndDate=enddt,\n       Volatility=vol,\n       PlotTitle = plottitle\n  )\n}\n#########################################################################\n# simple function to plot the data and include the title\n#########################################################################\nStockPlot <- function(stockname) {\n  \n  autoplot.zoo(stockname$Data) + \n    ggtitle(stockname$PlotTitle) \n  \n}\n```\n# Unit 9.5 Preparing Financial Data\n\nFor this assignment we will look at historical stock price data, calculate the overall volatility of the stock, calculate the log returns and plot volatility for three different decay factors\n\nProcter and Gamble (PG) was the assigned stock for this this project.\n\n  >Procter & Gamble Co provides consumer packaged goods. It markets its products in about 180 countries through mass merchandisers, grocery stores, membership club stores, drug stores, department stores among others. for more information on Proctor and Gamble see <https://www.thestreet.com/quote/PG/details/profile.html>\n\n# Proctor and Gamble Historical Stock price\n\n```{r getPG ,echo=FALSE, fig.height=2, fig.width=8}\n\nstockPG <- AnalyzeStock(\"PG\")\nStockPlot(stockPG)\n```\n\n# Compare PG to the S&P 500 over the same time period\n\n```{r getSNP ,echo=FALSE, fig.height=2, fig.width=8}\n\nstockSNP <- AnalyzeStock(\"^gspc\")\nStockPlot(stockSNP)\n```\n\n# Examine Log Returns for PG\n\nThis chart plots the difference in the log of each days closing price to the log of the previous day. \nUsing the log of the closing price lets us add the returns over the time period.  Percent returns are not additive. \n```{r logreturns, echo=FALSE, fig.height=6, fig.width=8}\nplot(stockPG$LogReturns) \ntitle(main=\"log returns for stock PG\")\nplot(stockSNP$LogReturns) \ntitle(main=\"log returns for S&P 500\")\n```\n\n# Calculate and plot volativity using decay factors of 10,30,100 over the time period\n\n```{r plotVolativity, echo=FALSE, fig.height=5, fig.width=8}\nvol10<- Volhistorical(10,stockPG$LogReturns)\nvol30<- Volhistorical(30,stockPG$LogReturns)\nvol100<- Volhistorical(100,stockPG$LogReturns)\n\n\nplot(vol10,type=\"l\",xlab=\"index\",ylab=\"Volatility\")\ntitle(main=paste(\"Plot of volatility for \",stockPG$Ticker,\" for the period \",stockPG$BeginDate,\" to \",stockPG$EndDate,sep=\"\"))\nlines(vol30,type=\"l\", col=\"red\")\nlines(vol100,type=\"l\",col=\"blue\")\nlegend(5000,.20,c(\"10\",\"30\",\"100\"), lty=c(1,1,1),lwd=c(2.5,2.5,2.5),col=c(\"black\",\"red\",\"blue\"),title=\"Decay Factor\")\n\n```\n\n# Methodology\n\nThe functions used to calculate ovarall volatility, and historical volatility by time period are included below\n\n\n```{r echo=FALSE}\nread_chunk('./analysis/functions.R')\n```\n\n```{r Unit9_5_Functions,eval=FALSE}\n<<Unit9_5_Functions>>\n```",
    "created" : 1468808507018.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2139579087",
    "id" : "E2937887",
    "lastKnownWriteTime" : 1468808517,
    "last_content_update" : 1468808517405,
    "path" : "~/GitHub/Unit9_FinancialData/RLisbonaMSDS6306Unit9_5FinancialData.Rmd",
    "project_path" : "RLisbonaMSDS6306Unit9_5FinancialData.Rmd",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "relative_order" : 2,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_markdown"
}